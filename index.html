<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Bagus Uploader</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center min-h-screen bg-gradient-to-r from-blue-500 to-purple-500">
  <div class="bg-white p-6 rounded-lg shadow max-w-md w-full text-center">
    <h1 class="text-xl font-bold">Bagus Uploader</h1>
    <p class="text-gray-600 mb-4">Upload file ke URL</p>

    <label for="fileInput" class="cursor-pointer block border-2 border-dashed p-6 rounded-lg bg-gray-50 hover:bg-gray-100">
      <p>Pilih file (Max 3MB)</p>
      <input type="file" id="fileInput" hidden>
    </label>

    <div id="result" class="mt-4 hidden"></div>

    <script>
      document.getElementById('fileInput').addEventListener('change', function () {
        const file = this.files[0];
        if (file.size > 3 * 1024 * 1024) {
          return showResult("Ukuran file terlalu besar!", true);
        }

        const formData = new FormData();
        formData.append("file", file);

        fetch('/api/upload', {
          method: 'POST',
          body: formData
        })
        .then(res => res.json())
        .then(data => {
          if (data.status === "success") {
            showResult(`Upload berhasil! <br><a href="${data.fileUrl}" target="_blank" class="text-blue-600">${data.fileUrl}</a>`);
          } else {
            showResult(data.message, true);
          }
        });
      });

      function showResult(msg, isError = false) {
        const el = document.getElementById('result');
        el.innerHTML = `<p class="${isError ? 'text-red-600' : 'text-green-600'}">${msg}</p>`;
        el.classList.remove('hidden');
      }
    </script>
  </div>
</body>
</html>
